<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <record id="hr_tmsentry_summary_form" model="ir.ui.view">
            <field name="name">hr.tmsentry.summary.form</field>
            <field name="model">hr.tmsentry.summary</field>
            <field name="arch" type="xml">
                <form string="TMS Entry Summary">
                    <header>
                        <button name="action_calculation" type="object" data-hotkey="shift+g"
                            string="Calculation" class="oe_highlight" invisible="state != 'draft'"/>
                        <button name="transfer_payroll" type="object" data-hotkey="shift+g"
                            string="Transfer To Payroll" class="oe_highlight" invisible="state != 'approved'"/>
                        <button string="To Approved" name="btn_toapproved" type="object" invisible="state != 'draft'" />
                        <button string="Close" name="action_done" type="object" invisible="state != 'transfer_payroll'" />
                        <field name="state" widget="statusbar" statusbar_visible="draft,to_approved,transfer_payroll,done"/>
                    </header>
                    <sheet>
                        <group string="TMS Entry - Summary" name="entry_summary">
                            <group>
                                <field name="state" readonly="True" />
                                <field name="area_id"
                                    options="{'no_create': True,'no_quick_create': True, 'no_create_edit': True}" required="1" readonly="True"/>
                                <field name="branch_ids" invisible="1" />
                                <field name="department_id"
                                    options="{'no_create': True,'no_quick_create': True, 'no_create_edit': True}" required="1" readonly="True"/>

                            </group>
                            <group>
                                <field name="branch_id"
                                    options="{'no_create': True,'no_quick_create': True, 'no_create_edit': True}" required="1" readonly="True"/>
                                <field name="job_id"
                                    options="{'no_create': True,'no_quick_create': True, 'no_create_edit': True}" required="1" readonly="True" />
                                <field name="periode_id"  options="{'no_create': True,'no_quick_create': True, 'no_create_edit': True}" readonly="True" />
                                <field name="date_from" required="1" readonly="True" force_save="1"/>
                                <field name="date_to" required="1" readonly="True" force_save="1"/>
                            </group>
                        </group>
                        <group>
                                <field name="nik" required="1" readonly="True" />
                                <field name="employee_id" required="1" readonly="True" />
                        </group>
                        <notebook>
                            <page name="tms_details" string="TMS Entry Details">
                                <field name="tmsentry_ids" required="1" readonly="1"
                                  context="{
                                       'employee_id': employee_id,
                                       'form_view_ref': 'sanbe_hr_tms.hr_tmsentry_form_ext',
                                       'target': 'current'
                                    }"
                                       create="0" edit="0" delete="0" force_save="1">
                                    <tree default_order='employee_id,dates' decoration-info="day_type == 'h'" decoration-danger="attendence_status in ['absent']" create="False" edit="tmsentry_status != 'transfer_payroll'" delete="False" force_save="1">
                                        <field name="tmsentry_status" column_invisible="1"/>
                                        <field name="tmsentry_id" column_invisible="1" />
                                        <field name="emp_id" column_invisible="1" />
                                        <field name="employee_id" column_invisible="1" />
                                        <field name="area_id" column_invisible="1" />
                                        <field name="department_id" column_invisible="1" />
                                        <field name="job_id" column_invisible="1" />
                                        <field name="nik" column_invisible="1" />
                                        <field name="dates" readonly="1" />
                                        <field name="day_type" readonly="1"/>
                                        <field name="wdcode" readonly="1"/>
                                        <field name="tgl_masuk" readonly="1"/>
                                        <field name="time_in" widget="easy_timepicker" readonly="1"/>
                                        <field name="time_in_edited" widget="easy_timepicker" readonly="1"/>
                                        <field name="tgl_keluar" readonly="1"/>
                                        <field name="time_out" widget="easy_timepicker" readonly="1"/>
                                        <field name="time_out_edited" widget="easy_timepicker" readonly="1"/>
                                        <field name="att_time" widget="easy_timepicker" readonly="1"/>
                                        <field name="attendence_status" readonly="1"/>
                                        <field name="delayed" widget="easy_timepicker" readonly="1"/>
                                        <field name="approval_ot_from" widget="easy_timepicker" readonly="1"/>
                                        <field name="approval_ot_to" widget="easy_timepicker" readonly="1"/>
                                        <field name="ot1_timex" readonly="1"/>
                                        <field name="ot2_timex" readonly="1"/>
                                        <field name="ot3_timex" readonly="1"/>
                                        <field name="ot4_timex" readonly="1"/>
                                        <field name="ot_auto_timex" readonly="1"/>
                                        <field name="premi_attendee" readonly="1"/>
                                        <field name="tunjangan_trp" readonly="1"/>
                                        <field name="tunjagan_meal" readonly="1"/>
                                        <field name="tms_status" readonly="1"/>
                                        <field name="approved" column_invisible="1"/>
                                        <field name="ot_approve" column_invisible="1"/>
                                        <field name="sanbe_readytoapprove" column_invisible="1"/>
                                        <button name="approved_data" type="object" string="Approved" class="fa fa-check" readonly="tmsentry_status=='transfer_payroll'"/>
                                        <button name="btn_reject" type="object" string="Reject" class="fa fa-ban" readonly="tmsentry_status=='transfer_payroll'"/>
                                        <button name="ambil_view" type="object" string="Edit" class="fa fa-edit" readonly="tmsentry_status=='transfer_payroll'"/>
                                    </tree>
                                </field>
                                <group name="note_group" col="12" class="mt-4 mt-md-0">
                                    <div class="clearfix"/>
                                    <group colspan="4">
                                        <field name="attendee_count" colspan="1" readonly="1"/>
                                        <field name="sick_count"  colspan="1" readonly="1"/>
                                        <field name="leave_count" colspan="1" readonly="1"/>
                                        <field name="absent_count" colspan="1" readonly="1"/>
                                    </group>
                                    <group colspan="4">
                                        <field name="permission_count" colspan="1" readonly="1"/>
                                        <field name="outstation_count" colspan="1" readonly="1"/>
                                        <field name="delay_total" widget="easy_timepicker" colspan="1" readonly="1"/>
                                        <field name="ot_auto_totalx"  colspan="1" readonly="1"/>
                                    </group>
                                    <group colspan="4">
                                        <field name="ot1_totalx" colspan="1" readonly="1"/>
                                        <field name="ot2_totalx"  colspan="1" readonly="1"/>
                                        <field name="ot3_totalx" colspan="1" readonly="1"/>
                                        <field name="ot4_totalx" colspan="1" readonly="1"/>
                                    </group>
                                    <group colspan="4">
                                        <field name="pattendace_count" colspan="1" readonly="1"/>
                                        <field name="nightshift_count" colspan="1" readonly="1"/>
                                        <label for="is_deduction" string="Deduction Totals"/>
                                        <div class="mr8 oe_inline">
                                            <field name="is_deduction" class="mr8 oe_inline"/>
                                            <field name="deduction" invisible="is_deduction != True" readonly="is_deduction != True" class="mr8 oe_inline"/>
                                        </div>
                                    </group>
                                    <div class="clearfix"/>
                                </group>
                            </page>
                        </notebook>
                        </sheet>
                        <div class="oe_chatter">
                            <field name="message_follower_ids"/>
                            <field name="activity_ids"/>
                            <field name="message_ids"/>
                        </div>
                </form>
            </field>
        </record>

        <record id="hr_tmsentry_sumary_tree" model="ir.ui.view">
            <field name="name">hr.tmsentry.sumarry.tree</field>
            <field name="model">hr.tmsentry.summary</field>
            <field name="arch" type="xml">
                <tree string="HR TMS Entry Summary Tree" >
                    <field name="employee_id" />
                    <field name="nik" />
                    <field name="area_id" />
                    <field name="department_id" />
                    <field name="job_id" />
                    <field name="date_from" />
                    <field name="date_to" />
                </tree>
            </field>
        </record>

        <record id="hr_tmsentry_sumary_tree_ext" model="ir.ui.view">
            <field name="name">hr.tmsentry.sumarry.tree.ext</field>
            <field name="model">hr.tmsentry.summary</field>
            <field name="inherit_id" ref="sanbe_hr_tms.hr_tmsentry_sumary_tree"/>
            <field name="mode">extension</field>
            <field name="arch" type="xml">
                <xpath expr="//tree" position="inside">
                    <header>
                        <!--button name="action_reconcile" type="object" string="Reconcile" groups="account.group_account_user"/-->
                        <button name="mass_approve" type="object" string="Approve"/>
                    </header>
                </xpath>
            </field>
        </record>

        <record id="hr_tmsentry_sumary_view_search" model="ir.ui.view">
            <field name="name">hr.tms.tree.view.search</field>
            <field name="model">hr.tmsentry.summary</field>
            <field name="arch" type="xml">
                <search string="TMS Entry">
                    <field name="employee_id" filter_domain="[('employee_id', 'child_of', self)]"/>
                    <field name="tmsentry_ids" filter_domain="[('tmsentry_ids', 'child_of', self)]"/>
                    <field name="nik" string="NIK"/>
                    <filter string="Department" name="department_id"
                            context="{'group_by':'department_id'}"/>
                    <filter string="Periode" name="periode_id"
                            context="{'group_by':'periode_id'}"/>
                    <filter string="Employee" name="employee_id"
                            context="{'group_by':'employee_id'}"/>
                </search>
            </field>
        </record>
        <record id="action_hr_tmsentry_summary" model="ir.actions.act_window">
            <field name="name">TMS Entry Summary</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.tmsentry.summary</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_periode_id':1}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    No Report HR TMS Entry Summary
                </p>
                <p>
                    Create new HR TMS Entry Summary
                </p>
            </field>
        </record>

    </data>
</odoo>