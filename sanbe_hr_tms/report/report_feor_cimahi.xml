<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="paperformat_feor_cimahi" model="report.paperformat">
            <field name="name">Paperformat FEOR Cimahi</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="orientation">Landscape</field>
            <field name="margin_top">30</field>
            <field name="margin_bottom">15</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">5</field>
            <field name="dpi">90</field>
        </record>

        <!-- Hide button print report default odoo pada roda gigi dengan cara comment param binding_model_id -->
        <record id="report_feor_cimahi" model="ir.actions.report">
            <field name="name">Report FEOR Cimahi</field>
            <field name="model">hr.overtime.planning</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">sanbe_hr_tms.template_feor_cimahi</field>
            <field name="report_file">sanbe_hr_tms.template_feor_cimahi</field>
            <field name="print_report_name">'%s' % (object.name)</field>
            <field name="binding_model_id" eval="False"></field>
            <field name="binding_type">report</field>
            <field name="paperformat_id" ref="sanbe_hr_tms.paperformat_feor_cimahi"/>
        </record>

        <template id="template_feor_cimahi">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-set="company" t-value="res_company"/>
                    <t t-call="web.basic_layout">
                        <style>
                            .header {
                            width: 100%;
                            overflow: hidden;
                            }

                            .line-1 {
                            border-top: 2px solid black;
                            margin-bottom: 5px;
                            }

                            .logo {
                            margin-left: 20px;
                            }

                            .metadata-table {
                            font-size: 12px;
                            width: 100%;
                            border: none;
                            border-collapse: collapse;
                            text-align: right;
                            }
                            .metadata-table,
                            .metadata-table td,
                            .metadata-table th {
                            border: none;
                            border-spacing: 0;
                            border-collapse: collapse;
                            }
                            .metadata-table p {
                            margin-bottom: 2px;
                            }

                            .metadata-table .label-cell {
                            padding-right: 10px;
                            text-align: left;
                            }

                            .metadata-table .value-cell {
                            text-align: left;
                            }

                            .title {
                            font-weight: bold;
                            font-size: 16pt;
                            }

                            .middle-line1 {
                            border: none;
                            border-top: 1.5px solid black;
                            margin: 2px 0;
                            }

                            .middle-line2 {
                            border: none;
                            border-top: 1.5px solid black;
                            margin-top: 2px;
                            margin-bottom: 5px;
                            }

                            .kotak {
                            display: inline-block;
                            border: 2px solid red;
                            padding: 5px;
                            font-size: 20px;
                            font-family: Arial, sans-serif;
                            color: red;
                            }

                            .header-table {
                            border: 1.5px solid black;
                            }

                            .header1 {
                            background-color: #d3d3d3;
                            font-weight: bold;
                            }

                            .header1, .value1 {
                            border: 1.5px solid black;
                            padding: 8px;
                            text-align: center;
                            vertical-align: middle;
                            }

                            .detail-table {
                            border: 1.5px solid black;
                            }

                            .header2, .value2 {
                            border: 1.5px solid black;
                            padding: 8px;
                            text-align: center;
                            vertical-align: middle;
                            }

                            .footer-line1 {
                            border: none;
                            border-top: 2px solid black;
                            margin: 2px 0;
                            }

                            .footer-text {
                            font-size: 10px;
                            font-style: italic;
                            }
                        </style>
                        <t t-set="counter" t-value="0"/>
                        <div class="header">
                            <div style="border-top: 1px solid black; margin-bottom: 1px;"></div>
                            <div style="border-top: 1px solid black; margin-bottom: 5px;"></div>
                            <table style="width: 100%; border: none; border-collapse: collapse;">
                                <tr>
                                    <td style="width: 16.66%; text-align: center; border: none; padding: 5px;">
                                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" alt="Logo"
                                             style="max-width: 150px; height: auto;"/>
                                    </td>

                                    <td colspan="7" class="title"
                                        style="width: 55%; text-align: center; border: none; padding: 0;">
                                        <span style="font-size: 14pt; font-family: 'Times New Roman';">
                                            FORM EMPLOYEE OVERTIME REQUEST AND REALIZATION
                                            <br/>
                                            (FEOR)
                                        </span>
                                    </td>

                                    <!-- Metadata -->
                                    <td colspan="3" style="width: 23%; text-align: right; border: none; padding: 0;">
                                        <table class="metadata-table"
                                               style="font-size: 7pt; font-family: 'Times New Roman'; line-height: 1; width: 100%; border: none; border-collapse: collapse; padding-right: 10px; text-align: left;">
                                            <tbody style="border: none;">
                                                <tr style="border: none;">
                                                    <td class="label-cell" style="padding-right: 2px; text-align: left;">No.
                                                    </td>
                                                    <td class="value-cell" style="text-align: left;">:
                                                        HRD-NS/FOR/LG/033
                                                    </td>
                                                </tr>
                                                <tr style="border: none;">
                                                    <td class="label-cell"
                                                        style="padding-right: 2px; text-align: left; border: none;">
                                                        Revision
                                                    </td>
                                                    <td class="value-cell" style="text-align: left;">: 00
                                                    </td>
                                                </tr>
                                                <tr style="border: none;">
                                                    <td class="label-cell"
                                                        style="padding-right: 2px; text-align: left; border: none;">
                                                        Effective Date
                                                    </td>
                                                    <td class="value-cell" style="text-align: left;">: 02 Jan
                                                        2024
                                                    </td>
                                                </tr>
                                                <tr style="border: none;">
                                                    <td class="label-cell"
                                                        style="padding-right: 2px; text-align: left; border: none;">
                                                        Next Review Date
                                                    </td>
                                                    <td class="value-cell" style="text-align: left;">: 02 Jan
                                                        2027
                                                    </td>
                                                </tr>
                                                <tr style="border: none;">
                                                    <td class="label-cell"
                                                        style="padding-right: 2px; text-align: left; border: none;">
                                                        Page
                                                    </td>
                                                    <td class="value-cell" style="text-align: left; ">:
                                                        <span class="page"></span>
                                                        of
                                                        <span class="topage"></span>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </table>
                            <div style="border-top: 1px solid black; margin-bottom: 1px;"></div>
                            <div style="border-top: 1px solid black; margin-bottom: 5px;"></div>
                        </div>
                        <div class="page">
                            <t t-set="total_employees" t-value="len(doc.hr_ot_planning_ids)"/>
                            <t t-set="employees_per_page" t-value="len(doc.hr_ot_planning_ids)"/>
                            <t t-set="total_pages"
                               t-value="((total_employees + employees_per_page - 1) // employees_per_page) or 1"/>
                            <div class="line-1" style="border-top: 2px solid black; margin-bottom: 5px;"></div>
                            <!-- Hitung total halaman berdasarkan data employees -->

                            <!-- Loop untuk setiap halaman -->
                            <t t-foreach="range(total_pages)" t-as="page_num">
                                <t t-set="start_index" t-value="page_num * employees_per_page"/>
                                <t t-set="end_index" t-value="(page_num + 1) * employees_per_page"/>
                                <t t-set="page_employees" t-value="doc.hr_ot_planning_ids[start_index:end_index]"/>
                                <!-- <table class="table table-bordered" style="width: 100%; border-collapse: collapse;"> -->
                                <table style="width: 100%;">
                                    <style>
                                        table {
                                        border-collapse: collapse;
                                        width: 100%;
                                        page-break-inside: auto;
                                        font-size: 8pt;
                                        }
                                        thead {
                                        display: table-header-group;
                                        font-size: 8pt;
                                        }
                                        tfoot {
                                        display: table-footer-group;
                                        font-size: 8pt;
                                        }
                                        tr {
                                        page-break-inside: avoid;
                                        page-break-after: auto;
                                        font-size: 8pt;
                                        }
                                        td {
                                        border: 1px solid #000;
                                        font-size: 8pt;
                                        padding: 4px;
                                        }
                                    </style>
                                    <thead>
                                        <tr valign="top">
                                            <td colspan="2"
                                                style="width: 9%; border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Section</b>
                                            </td>
                                            <td colspan="3"
                                                style="width: 27%; border: 1px solid #000000; padding: 4px;">
                                                <span t-field="doc.department_id.name"/>
                                            </td>
                                            <td colspan="4" align="center"
                                                style="width: 27%; border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Plan/Proposal</b>
                                            </td>
                                            <td colspan="4" align="center"
                                                style="width: 36%; border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Realization</b>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td colspan="2"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Day</b>
                                            </td>
                                            <td colspan="3" style="border: 1px solid #000000; padding: 4px;">
                                                <span t-field="doc.request_day_name"/>
                                            </td>
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; ">
                                                <b>Prepare by</b>
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                <b>Review By</b>
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                <b>Approved By</b>
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                <b>Checked By</b>
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                <b>Review By</b>
                                            </td>
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px;">
                                                <b>Approved By</b>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td colspan="2"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Date</b>
                                            </td>
                                            <td colspan="3" style="border: 1px solid #000000; padding: 4px;">
                                                <span t-field="doc.periode_from" t-options='{"widget": "date"}'/>
                                            </td>
                                            <td colspan="2" rowspan="2"
                                                style="border: 1px solid #000000; padding: 4px; height: 50px; text-align: center; vertical-align: middle; font-weight: bold; color: red;">
                                                <div class="kotak">APPROVED</div>
                                            </td>
                                            <td rowspan="2"
                                                style="border: 1px solid #000000; padding: 4px; height: 50px; text-align: center; vertical-align: middle; font-weight: bold; color: red;">
                                                <div class="kotak">APPROVED</div>
                                            </td>
                                            <td rowspan="2"
                                                style="border: 1px solid #000000; padding: 4px; height: 50px; text-align: center; vertical-align: middle; font-weight: bold; color: red;">
                                                <div class="kotak">APPROVED</div>
                                            </td>
                                            <td rowspan="2" style="border: 1px solid #000000; padding: 4px;">
                                                <br/>
                                            </td>
                                            <td rowspan="2" style="border: 1px solid #000000; padding: 4px;">
                                                <br/>
                                            </td>
                                            <td rowspan="2" colspan="2"
                                                style="border: 1px solid #000000; padding: 4px;">
                                                <br/>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td colspan="2"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Total Personil</b>
                                            </td>
                                            <td colspan="3" style="border: 1px solid #000000; padding: 4px;">
                                                <span t-field="doc.count_record_employees"/>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td colspan="2"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Shift</b>
                                            </td>
                                            <td colspan="3" style="border: 1px solid #000000; padding: 4px;">
                                                <span t-field="doc.default_ot_hours"/>
                                            </td>
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px;">Supervisor
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                Manager
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                Plant
                                                Manager
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                Supervisor
                                            </td>
                                            <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                Manager
                                            </td>
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px;">Plant Manager
                                            </td>
                                        </tr>

                                        <tr valign="top">
                                            <td rowspan="3"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>No</b>
                                            </td>
                                            <td rowspan="3"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>NIK</b>
                                            </td>
                                            <td colspan="2" rowspan="3"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Name</b>
                                            </td>
                                            <td rowspan="3"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Sign</b>
                                            </td>
                                            <td colspan="4" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Overtime Proposal</b>
                                            </td>
                                            <td colspan="4" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Realization Checked</b>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Time</b>
                                            </td>
                                            <td rowspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Work Plan</b>
                                            </td>
                                            <td rowspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Output Plan</b>
                                            </td>
                                            <td rowspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Output Realization</b>
                                            </td>
                                            <td rowspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Explanation Deviation</b>
                                            </td>
                                            <td colspan="2" align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Verification Time</b>
                                            </td>
                                        </tr>
                                        <tr valign="top">
                                            <td align="center"
                                                style="border: 1px solid #000000; background-color: #c2f7f7">
                                                <b>Start</b>
                                            </td>
                                            <td align="center"
                                                style="border: 1px solid #000000; background-color: #c2f7f7">
                                                <b>Finish</b>
                                            </td>
                                            <td align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Start</b>
                                            </td>
                                            <td align="center"
                                                style="border: 1px solid #000000; padding: 4px; background-color: #c2f7f7">
                                                <b>Finish</b>
                                            </td>
                                        </tr>
                                    </thead>
                                    <tbody style="font-size: 8pt; font-family: 'Arial';">
                                        <!-- Tampilkan employees untuk halaman ini -->
                                        <t t-foreach="page_employees" t-as="employee">
                                            <tr valign="top">
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-esc="start_index + employee_index + 1"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.nik"/>
                                                </td>
                                                <td colspan="2" style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.employee_id.name"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <br/>
                                                </td>
                                                <td align="center" style="border: 1px solid #000000;">
                                                    <span t-field="employee.ot_plann_from_char"/>
                                                </td>
                                                <td align="center" style="border: 1px solid #000000;">
                                                    <span t-field="employee.ot_plann_to_char"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.work_plann"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.output_plann"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-esc="employee.output_realization if employee.output_realization else ''"/>
                                                </td>
                                                <td style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.explanation_deviation"/>
                                                </td>
                                                <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.verify_time_from_char"/>
                                                </td>
                                                <td align="center" style="border: 1px solid #000000; padding: 4px;">
                                                    <span t-field="employee.verify_time_to_char"/>
                                                </td>
                                            </tr>
                                        </t>
                                    </tbody>
                                    <t t-if="page_num + 1 == total_pages">
                                        <tr valign="top" style="font-size: 8pt; font-family: 'Arial';">
                                            <td colspan="9" style="border: 1px solid #000000; padding: 4px;">CC : 1.
                                                HRD
                                                2.
                                                CA
                                            </td>
                                            <td colspan="2"
                                                style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0.04in; padding-right: 0in">
                                                Verified by HRD :
                                            </td>
                                            <td colspan="2"
                                                style="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: none; border-right: 1px solid #000000; padding-top: 0.04in; padding-bottom: 0.04in; padding-left: 0in; padding-right: 0.04in">
                                                <strong>
                                                    <font color="#ff0000">
                                                        <b>Approved</b>
                                                    </font>
                                                </strong>
                                            </td>
                                        </tr>
                                    </t>
                                </table>
                                <br/>
                                <!-- Tambahkan page break setelah setiap halaman kecuali yang terakhir -->
                                <t t-if="page_num + 1 != total_pages">
                                    <div style="page-break-after: always;"></div>
                                </t>
                            </t>
                            <div style="font-size: 7pt; font-family: 'Arial';">
                                <em>* Yang mempropose dan menyetujui harus paham, rasional dan bertanggung jawab
                                    dalam penentuan jumlah jam dan orang yang dibutuhkan untuk pekerjaan
                                    tersebut.
                                </em>
                                <br/>
                                <em>** Form realisasi yang sudah diisi dan diverifikasi / ttd harus masuk ke
                                    bagian
                                    HRD maksimal 1 (satu) hari setelah pelaksanaan overtime (maksimal jam
                                    09:00).
                                </em>
                            </div>
                        </div>
                        <div class="footer">
                            <hr class="footer-line1"
                                style="border: none; border-top: 2px solid black; margin: 2px 0;"/>
                            <div style="float: left;">
                                <span style="font-size: 10px; font-style: italic;">
                                    \LAN\Release\SanbeU2\HRD\NS\FOR\HRD-NS.FOR.LG.033 - Form Employee Overtime
                                    Request an Realization (FEOR) - R00.doc
                                </span>
                            </div>
                            <div style="float: right; text-align: right; font-size: 10px; font-style: italic;">
                                Printed By : <span t-esc="user.name"></span> on
                                <span t-esc="(datetime.datetime.now() + datetime.timedelta(hours=7)).strftime('%d/%m/%Y %H:%M:%S')"/>
                            </div>
                            <br/>
                        </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>
