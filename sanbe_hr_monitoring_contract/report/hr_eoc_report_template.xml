<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        <template id="hr_eoc_report_pdf">
            <t t-call="web.basic_layout">
                <div class="header">
                    <t t-set="company" t-value="res_company" />
                    <table style="width=100%; margin-right: auto; border: 0px solid transparent;">
                        <tr>
                            <td>
                                <img
                                    t-if="company.logo"
                                    t-att-src="image_data_uri(company.logo)"
                                    style="max-height: 100px; width: 200px;" alt="Logo"
                                />
                            </td>
                        </tr>
                    </table>
                    <div class="row">
                        <div class="col-12">
                            <div style="border-bottom: 1px solid black; margin-bottom: 2px;" />
                            <div style="border-bottom: 4px solid black;" />
                        </div>
                    </div>
                    <table style="width=100%; margin-left: auto; border: 0px solid transparent;">
                        <tr>
                            <td class="text-left" style="vertical-align: middle; font-family: 'Bookman Old Style', Georgia, serif;">
                                <strong>
                                    <span style="font-size:17px;" t-field="company.name" />
                                    Pharmaceutical Manufacturer
                                </strong>
                            </td>
                        </tr>
                        <tr>
                            <td style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" class="text-left">
                            <t t-if="o.branch_id.street">
                                <strong>
                                    <span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.street" />
                                </strong>
                            </t>
                            <t t-if="o.branch_id.street2">
                                <strong>
                                    <span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.street2" />
                                </strong>
                            </t>
                            <t t-if="o.branch_id.city">
                                <strong>
                                    <span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.city" />
                                </strong>
                            </t>
                                <strong>
                                    <br /> Telp: <t t-if="o.branch_id.phone"><span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.phone" /></t>
                                    <br /> Fax: <t t-if="o.branch_id.fax"><span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.fax" /></t>
                                    <br />
                                    <t t-if="o.branch_id.city"><span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.city" /></t> <t t-if="o.branch_id.zip"><span style="font-size:13px; font-family: 'Bookman Old Style', Georgia, serif;" t-field="o.branch_id.zip" /></t>
                                </strong>
                            </td>
                        </tr>
                    </table>
                </div>
                <div class="page">
                    <div class="text-center" style="text-align: center;">
                        <div class="row">
                            <div class="col-xs-6">
                                <t t-set="date" t-value="wizard.write_date"/>
                                <t t-set="dates" t-value="date.strftime('%d %B %Y').replace('January', 'Januari').replace('February', 'Februari').replace('March', 'Maret').replace('April', 'April').replace('May', 'Mei').replace('June', 'Juni').replace('July', 'Juli').replace('August', 'Agustus').replace('September', 'September').replace('October', 'Oktober').replace('November', 'November').replace('December', 'Desember')"/>
                                <br/>
                                <br/>
                                <p style="text-align: justify; font-size:16px;">
                                    <strong>Bandung, 
                                        <t t-esc="dates"/>
                                    </strong>
                                </p>
                            </div>
                        </div>
                        <div class="row">
                            <div style="text-align: left; font-size:16px;" class="col-xs-12">
                                <strong>
                                    <p>Kepada
                                        <br/>
                                    Yth. 
                                        <span t-field="o.name"/>
                                        <br/>
                                        <span t-field="o.department_id.name"/>
                                        <br/>
                                    Di Tempat.
                                    </p>
                                </strong>
                            </div>
                        </div>
                    </div>
                    <br/>
                    <div class="content">
                        <div class="row">
                            <div class="col-xs-12">
                                <p style="text-align:justify; font-size:16px;">Nomor: 
                                    <strong>
                                        <span t-field="wizard.name"/>
                                    </strong>
                                    <br/>
                                    Perihal: 
                                    <strong>
                                        <u>Pemberitahuan berakhirnya Perjanjian Kerja Waktu Tertentu (PKWT)</u>
                                    </strong>
                                </p>
                            </div>
                        </div>
                    <br/>
                        <p style="text-align:justify; font-size:16px;"> Dengan hormat, <br/>
                            Melalui surat ini kami sampaikan mengenai Perjanjian Kerja Waktu Tertentu (PKWT), atas nama :
                        </p>


                        <t t-set="employees" t-value="env['hr.employee.contract.monitoring'].search([('coach_id', '=', o.id),('department_id', '=', wizard.department_id.id)])"/>
                        <table border="1" cellspacing="0" cellpadding="4" style="border-collapse: collapse; width: 100%; font-size: 16px;">
                            <thead>
                                <tr>
                                    <th style="border: 1px solid black;">No</th>
                                    <th style="border: 1px solid black;">Nama Karyawan</th>
                                    <th style="border: 1px solid black;">Departemen</th>
                                    <th style="border: 1px solid black;">Jabatan</th>
                                    <th style="border: 1px solid black;">Berakhir Tanggal</th>
                                    <th style="border: 1px solid black;">Perpanjangan PKWT Tahun ke</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="idx" t-value="1"/>
                                <t t-foreach="employees" t-as="e">
                                    <tr>
                                        <td><t t-esc="idx"/></td>
                                        <td><t t-esc="e.employee_id.name"/></td>
                                        <td><t t-esc="e.employee_id.department_id.name"/></td>
                                        <td><t t-esc="e.employee_id.job_id.name"/></td>
                                        <td><t t-esc="e.employee_id.contract_id.date_end.strftime('%d %B %Y').replace('January', 'Januari').replace('February', 'Februari').replace('March', 'Maret').replace('April', 'April').replace('May', 'Mei').replace('June', 'Juni').replace('July', 'Juli').replace('August', 'Agustus').replace('September', 'September').replace('October', 'Oktober').replace('November', 'November').replace('December', 'Desember')"/></td>
                                        <td><t t-esc="e.employee_id.contract_id.contract_year"/></td>
                                    </tr>
                                    <t t-set="idx" t-value="idx + 1"/>
                                </t>
                            </tbody>
                        </table>


                        <p style="text-align:justify; font-size:16px;">
                                            Untuk itu, kami mohon informasi selanjutnya terkait status yang bersangkutan, Jika PKWT-nya tidak diperpanjang, kami akan menghitungkan hari kerja dan sisa cutinya untuk dibayarkan.
                        </p>
                        <p style="text-align:justify; font-size:16px;">
                                            Jika diperpanjang maka sertakan:
                            
                            <ol style="text-align:justify; font-size:16px;">
                                <li>
                                                            Surat permohonan perpanjangan kontrak karyawan yang ditujukan kepada 
                                    <strong>Personalia &amp; G.A. Manager</strong> serta mengisi "
                                    <strong>Form Tenaga Kerja</strong>".
                                
                                </li>
                                <li>
                                                            Mengisi formulir analisa perpanjangan kontrak karyawan untuk di review oleh HRD Corporate.
                                </li>
                            </ol>
                        </p>
                        <p style="text-align:justify; font-size:16px;">
                                                Jawaban dapat langsung ditulis pada tempat yang kosong di surat ini dan 
                            <strong>
                                <u>segera dikembalikan ke Personalia</u>
                            </strong> paling lambat 
                            <strong>7 hari</strong> sebelum berakhirnya jangka waktu PKWT yang bersangkutan.
                        
                        </p>
                        <p style="text-align:justify; font-size:16px;">Terlampir data absensi selama 1 tahun sebagai bahan pertimbangan.</p>
                        <t t-if="len(employees) > 3">
                            <div style="page-break-before: always;" />
                            <br/>
                        </t>
                        <p style="text-align:justify; font-size:16px;">
                                            Selanjutnya seluruh permohonan kontrak akan kami sampaikan kepada Owner untuk dimohonkan persetujuannya.</p>
                        <p style="text-align:justify; font-size:16px;"> Demikian informasi ini kami sampaikan, atas perhatian dan kerjasamanya, kami ucapkan terima kasih.</p>
                    </div>
                    <br/>
                    <div class="text-right">
                        <p style="font-size:16px;">Hormat kami,</p>
                        <br/>
                        <br/>
                        <p style="font-size:16px;">
                            <strong>
                                <span>Asep Rohman, SH.</span>
                            </strong>
                            <br/>
                            <br/>
                            <span>Personnel &amp; General Affairs Manager</span>
                        </p>
                    </div>
                </div>
            </t>
        </template>
        <template id="hr_eoc_report_template">
            <t t-call="web.html_container">
            
                <t t-set="wizard" t-value="docs and docs[0]"/>
                <t t-set="parent_employees" t-value="wizard.parent_id and [wizard.parent_id] or env['hr.employee.contract.monitoring'].search([('department_id', '=', wizard.department_id.id)])"/>
                <t t-if="not wizard.parent_id">
                    <t t-set="parent_ids" t-value="env['hr.employee.contract.monitoring'].search([('department_id', '=', wizard.department_id.id)]).mapped('coach_id')"/>
                    <t t-set="parent_employees" t-value="parent_ids"/>
                </t>
                <t t-foreach="parent_employees" t-as="o">
                    <t t-call="sanbe_hr_monitoring_contract.hr_eoc_report_pdf"/>
                </t>
            </t>
        </template>
    </data>
</odoo>